<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Thalathat al-Usul: The Unabridged Scholarly Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #FAF9F6; color: #1A1614; overflow-x: hidden; }
        .arabic { font-family: 'Amiri', serif; line-height: 2.5; text-align: right; }
        .serif { font-family: 'Playfair Display', serif; }
        .transition-all-400 { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass-header { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid #EBDCCB; }
        .content-card { box-shadow: 0 25px 60px -15px rgba(74, 55, 40, 0.12); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const bookData = [
            {
                id: 1,
                category: "Introduction",
                title: "The Four Obligatory Matters",
                arabic: "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‡Ù Ø§Ù„Ø±ÙŽÙ‘Ø­Ù’Ù…ÙŽÙ†Ù Ø§Ù„Ø±ÙŽÙ‘Ø­ÙÙŠÙ…Ù. Ø§Ø¹Ù’Ù„ÙŽÙ…Ù’ Ø±ÙŽØ­ÙÙ…ÙŽÙƒÙŽ Ø§Ù„Ù„Ù‡Ù Ø£ÙŽÙ†ÙŽÙ‘Ù‡Ù ÙŠÙŽØ¬ÙØ¨Ù Ø¹ÙŽÙ„ÙŽÙŠÙ’Ù†ÙŽØ§ ØªÙŽØ¹ÙŽÙ„ÙÙ‘Ù…Ù Ø£ÙŽØ±Ù’Ø¨ÙŽØ¹Ù Ù…ÙŽØ³ÙŽØ§Ø¦ÙÙ„ÙŽ: Ø§Ù„Ø£ÙÙˆÙ„ÙŽÙ‰: Ø§Ù„Ù’Ø¹ÙÙ„Ù’Ù…ÙØ› ÙˆÙŽÙ‡ÙÙˆÙŽ Ù…ÙŽØ¹Ù’Ø±ÙÙÙŽØ©Ù Ø§Ù„Ù„Ù‡ÙØŒ ÙˆÙŽÙ…ÙŽØ¹Ù’Ø±ÙÙÙŽØ©Ù Ù†ÙŽØ¨ÙÙŠÙÙ‘Ù‡ÙØŒ ÙˆÙŽÙ…ÙŽØ¹Ù’Ø±ÙÙÙŽØ©Ù Ø¯ÙÙŠÙ†Ù Ø§Ù„Ø¥ÙØ³Ù’Ù„Ø§Ù…Ù Ø¨ÙØ§Ù„Ø£ÙŽØ¯ÙÙ„ÙŽÙ‘Ø©Ù. Ø§Ù„Ø«ÙŽÙ‘Ø§Ù†ÙÙŠÙŽØ©Ù: Ø§Ù„Ù’Ø¹ÙŽÙ…ÙŽÙ„Ù Ø¨ÙÙ‡Ù. Ø§Ù„Ø«ÙŽÙ‘Ø§Ù„ÙØ«ÙŽØ©Ù: Ø§Ù„Ø¯ÙŽÙ‘Ø¹Ù’ÙˆÙŽØ©Ù Ø¥ÙÙ„ÙŽÙŠÙ’Ù‡Ù. Ø§Ù„Ø±ÙŽÙ‘Ø§Ø¨ÙØ¹ÙŽØ©Ù: Ø§Ù„ØµÙŽÙ‘Ø¨Ù’Ø±Ù Ø¹ÙŽÙ„ÙŽÙ‰ Ø§Ù„Ø£ÙŽØ°ÙŽÙ‰ ÙÙÙŠÙ‡Ù.",
                phonics: "BismillÄhir-RahmÄnir-RahÄ«m. I'lam rahimakallÄh annahu yajibu 'alaynÄ ta'allumu arba'i masÄ'il: Al-Å«lÄ: Al-ilm... Al-thÄniyah: Al-'amalu bih. Al-thÄlithah: Al-da'watu ilayh. Al-rÄbi'ah: Al-sabru 'alal-adhÄ fÄ«h.",
                english: "In the name of Allah, the Most Merciful. Know, may Allah have mercy on you, that it is obligatory for us to learn four matters:\n1. Knowledge (Knowledge of Allah, His Prophet, and the religion with evidence).\n2. Action upon it.\n3. Calling to it.\n4. Patience upon the harm encountered therein.",
                scholarNote: "Knowledge is the foundation for speech and action. Scholarly commentaries (Ibn Uthaymeen) emphasize that these four traits are the only way to escape the 'Loss' mentioned in Surah al-Asr.",
                evidence: "Evidence: Surah al-Asr: 'By the time, indeed mankind is in loss...'. Imam Shafi'i said: 'If Allah had only revealed this Surah as a proof for His creation, it would have sufficed them.'"
            },
            {
                id: 2,
                category: "Introduction",
                title: "The Three Essential Obligations",
                arabic: "Ø§Ø¹Ù’Ù„ÙŽÙ…Ù’ Ø±ÙŽØ­ÙÙ…ÙŽÙƒÙŽ Ø§Ù„Ù„Ù‡Ù Ø£ÙŽÙ†ÙŽÙ‘Ù‡Ù ÙŠÙŽØ¬ÙØ¨Ù Ø¹ÙŽÙ„ÙŽÙ‰ ÙƒÙÙ„ÙÙ‘ Ù…ÙØ³Ù’Ù„ÙÙ…Ù ÙˆÙŽÙ…ÙØ³Ù’Ù„ÙÙ…ÙŽØ©Ù ØªÙŽØ¹ÙŽÙ„ÙÙ‘Ù…Ù Ù‡ÙŽØ°ÙÙ‡Ù Ø§Ù„Ø«ÙŽÙ‘Ù„Ø§Ø«Ù Ù…ÙŽØ³ÙŽØ§Ø¦ÙÙ„ÙØŒ ÙˆÙŽØ§Ù„Ù’Ø¹ÙŽÙ…ÙŽÙ„Ù Ø¨ÙÙ‡ÙÙ†ÙŽÙ‘: Ø§Ù„Ø£ÙÙˆÙ„ÙŽÙ‰: Ø£ÙŽÙ†ÙŽÙ‘ Ø§Ù„Ù„Ù‡ÙŽ Ø®ÙŽÙ„ÙŽÙ‚ÙŽÙ†ÙŽØ§ØŒ ÙˆÙŽØ±ÙŽØ²ÙŽÙ‚ÙŽÙ†ÙŽØ§ØŒ ÙˆÙŽÙ„ÙŽÙ…Ù’ ÙŠÙŽØªÙ’Ø±ÙÙƒÙ’Ù†ÙŽØ§ Ù‡ÙŽÙ…ÙŽÙ„Ø§Ù‹ØŒ Ø¨ÙŽÙ„Ù’ Ø£ÙŽØ±Ù’Ø³ÙŽÙ„ÙŽ Ø¥ÙÙ„ÙŽÙŠÙ’Ù†ÙŽØ§ Ø±ÙŽØ³ÙÙˆÙ„Ø§Ù‹... Ø§Ù„Ø«ÙŽÙ‘Ø§Ù†ÙÙŠÙŽØ©Ù: Ø£ÙŽÙ†ÙŽÙ‘ Ø§Ù„Ù„Ù‡ÙŽ Ù„Ø§ ÙŠÙŽØ±Ù’Ø¶ÙŽÙ‰ Ø£ÙŽÙ†Ù’ ÙŠÙØ´Ù’Ø±ÙŽÙƒÙŽ Ù…ÙŽØ¹ÙŽÙ‡Ù Ø£ÙŽØ­ÙŽØ¯ÙŒ ÙÙÙŠ Ø¹ÙØ¨ÙŽØ§Ø¯ÙŽØªÙÙ‡Ù... Ø§Ù„Ø«ÙŽÙ‘Ø§Ù„ÙØ«ÙŽØ©Ù: Ø£ÙŽÙ†ÙŽÙ‘ Ù…ÙŽÙ†Ù’ Ø£ÙŽØ·ÙŽØ§Ø¹ÙŽ Ø§Ù„Ø±ÙŽÙ‘Ø³ÙÙˆÙ„ÙŽØŒ ÙˆÙŽÙˆÙŽØ­ÙŽÙ‘Ø¯ÙŽ Ø§Ù„Ù„Ù‡ÙŽ Ù„Ø§ ÙŠÙŽØ¬ÙÙˆØ²Ù Ù„ÙŽÙ‡Ù Ù…ÙÙˆÙŽØ§Ù„Ø§Ø©Ù Ù…ÙŽÙ†Ù’ Ø­ÙŽØ§Ø¯ÙŽÙ‘ Ø§Ù„Ù„Ù‡ÙŽ ÙˆÙŽØ±ÙŽØ³ÙÙˆÙ„ÙŽÙ‡Ù.",
                phonics: "I'lam rahimakallÄh... Al-Å«lÄ: AnnallÄha khalaqanÄ... Al-thÄniyah: AnnallÄha lÄ yardÄ... Al-thÄlithah: Anna man atÄ'ar-rasÅ«la wa wahhadallÄh...",
                english: "1. Allah created us and provided for us, sending a Messenger. 2. Allah is not pleased with Shirk. 3. Loyalty must be for Allah and His Messenger alone.",
                scholarNote: "Point 1 concerns Rububiyyah (Lordship). Point 2 concerns Uluhiyyah (Worship). Point 3 concerns Al-Wala' wal-Bara' (Loyalty and Disavowal).",
                evidence: "Proof 1: Surah al-Muzzammil:15. Proof 2: Surah al-Jinn:18. Proof 3: Surah al-Mujadilah:22. This establishes that even the most pious angel or prophet cannot be worshipped with Allah."
            },
            {
                id: 3,
                category: "Introduction",
                title: "The Hanifiyyah",
                arabic: "Ø§Ø¹Ù’Ù„ÙŽÙ…Ù’ Ø£ÙŽØ±Ù’Ø´ÙŽØ¯ÙŽÙƒÙŽ Ø§Ù„Ù„Ù‡Ù Ù„ÙØ·ÙŽØ§Ø¹ÙŽØªÙÙ‡Ù: Ø£ÙŽÙ†ÙŽÙ‘ Ø§Ù„Ù’Ø­ÙŽÙ†ÙÙŠÙÙÙŠÙŽÙ‘Ø©ÙŽ Ù…ÙÙ„ÙŽÙ‘Ø©ÙŽ Ø¥ÙØ¨Ù’Ø±ÙŽØ§Ù‡ÙÙŠÙ…ÙŽ: Ø£ÙŽÙ†Ù’ ØªÙŽØ¹Ù’Ø¨ÙØ¯ÙŽ Ø§Ù„Ù„Ù‡ÙŽ ÙˆÙŽØ­Ù’Ø¯ÙŽÙ‡ÙØŒ Ù…ÙØ®Ù’Ù„ÙØµÙ‹Ø§ Ù„ÙŽÙ‡Ù Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†ÙŽ. ÙˆÙŽØ¨ÙØ°ÙŽÙ„ÙÙƒÙŽ Ø£ÙŽÙ…ÙŽØ±ÙŽ Ø§Ù„Ù„Ù‡Ù Ø¬ÙŽÙ…ÙÙŠØ¹ÙŽ Ø§Ù„Ù†ÙŽÙ‘Ø§Ø³ÙØŒ ÙˆÙŽØ®ÙŽÙ„ÙŽÙ‚ÙŽÙ‡ÙÙ…Ù’ Ù„ÙŽÙ‡ÙŽØ§.",
                phonics: "I'lam arshadakallÄh... Annal-hanÄ«fiyyata millata IbrÄhÄ«m: An ta'budallÄha wahdahu...",
                english: "The Hanifiyyah is the religion of Ibrahim: that you worship Allah alone, making the religion pure for Him. This is why Allah created all people.",
                scholarNote: "Hanifiyyah means turning away from Shirk towards Tawhid. This is the natural fitrah of the human soul.",
                evidence: "Proof: 'And I did not create the jinn and mankind except to worship Me' (Surah adh-Dhariyat: 56). Worship here means Tawhid."
            },
            {
                id: 4,
                category: "Foundation 1",
                title: "Knowledge of the Lord",
                arabic: "Ø§Ù„Ø£ÙŽØµÙ’Ù„Ù Ø§Ù„Ø£ÙŽÙˆÙŽÙ‘Ù„Ù: Ù…ÙŽØ¹Ù’Ø±ÙÙÙŽØ©Ù Ø§Ù„Ø±ÙŽÙ‘Ø¨ÙÙ‘. ÙÙŽØ¥ÙØ°ÙŽØ§ Ù‚ÙÙŠÙ„ÙŽ Ù„ÙŽÙƒÙŽ: Ù…ÙŽÙ†Ù’ Ø±ÙŽØ¨ÙÙ‘ÙƒÙŽØŸ ÙÙŽÙ‚ÙÙ„Ù’: Ø±ÙŽØ¨ÙÙ‘ÙŠÙŽ Ø§Ù„Ù„Ù‡Ù Ø§Ù„ÙŽÙ‘Ø°ÙÙŠ Ø±ÙŽØ¨ÙŽÙ‘Ø§Ù†ÙŠ ÙˆÙŽØ±ÙŽØ¨ÙŽÙ‘Ù‰ Ø¬ÙŽÙ…ÙÙŠØ¹ÙŽ Ø§Ù„Ù’Ø¹ÙŽØ§Ù„ÙŽÙ…ÙÙŠÙ†ÙŽ Ø¨ÙÙ†ÙØ¹ÙŽÙ…ÙÙ‡ÙØŒ ÙˆÙŽÙ‡ÙÙˆÙŽ Ù…ÙŽØ¹Ù’Ø¨ÙÙˆØ¯ÙÙŠ Ù„ÙŽÙŠÙ’Ø³ÙŽ Ù„ÙÙŠ Ù…ÙŽØ¹Ù’Ø¨ÙÙˆØ¯ÙŒ Ø³ÙÙˆÙŽØ§Ù‡Ù.",
                phonics: "Al-aslul-awwal: Ma'rifatur-Rabb... Fa qul: RabbiyallÄhul-ladhÄ« rabbÄnÄ«...",
                english: "First Principle: Knowledge of the Lord. 'My Lord is Allah, who nurtured me and all of creation with His favors. He is the one I worship.'",
                scholarNote: "Recognizing Allah as the Nurturer (Rabb) is the logical proof that He alone deserves worship (Ilah).",
                evidence: "Proof: 'Praise be to Allah, Lord of the Worlds' (1:2). Everything other than Allah is part of 'the worlds' and He is their Lord."
            },
            {
                id: 5,
                category: "Foundation 1",
                title: "The Signposts of the Lord",
                arabic: "ÙˆÙŽÙ…ÙÙ†Ù’ Ø¢ÙŠÙŽØ§ØªÙÙ‡Ù Ø§Ù„Ù„ÙŽÙ‘ÙŠÙ’Ù„ÙØŒ ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ù‡ÙŽØ§Ø±ÙØŒ ÙˆÙŽØ§Ù„Ø´ÙŽÙ‘Ù…Ù’Ø³ÙØŒ ÙˆÙŽØ§Ù„Ù’Ù‚ÙŽÙ…ÙŽØ±Ù. ÙˆÙŽÙ…ÙÙ†Ù’ Ù…ÙŽØ®Ù’Ù„ÙÙˆÙ‚ÙŽØ§ØªÙÙ‡Ù Ø§Ù„Ø³ÙŽÙ‘Ù…ÙŽØ§ÙˆÙŽØ§ØªÙ Ø§Ù„Ø³ÙŽÙ‘Ø¨Ù’Ø¹ÙØŒ ÙˆÙŽØ§Ù„Ø£ÙŽØ±ÙŽØ¶ÙÙˆÙ†ÙŽ Ø§Ù„Ø³ÙŽÙ‘Ø¨Ù’Ø¹ÙØŒ ÙˆÙŽÙ…ÙŽØ§ ÙÙÙŠÙ‡ÙÙ†ÙŽÙ‘ØŒ ÙˆÙŽÙ…ÙŽØ§ Ø¨ÙŽÙŠÙ’Ù†ÙŽÙ‡ÙÙ…ÙŽØ§.",
                phonics: "Wa min ÄyÄtihil-laylu, wan-nahÄru, wash-shamsu, wal-qamaru...",
                english: "His signs include the night, the day, the sun, and the moon. His creations include the seven heavens and the seven earths.",
                scholarNote: "Signs (Aayaat) are those things that change (like day/night), while Creations (Makhluqaat) are the vast structures themselves. Both prove His Rububiyyah.",
                evidence: "Proof: 'And of His signs are the night and the day and the sun and the moon...' (Surah Fussilat: 37)."
            },
            {
                id: 6,
                category: "Foundation 1",
                title: "Types of Worship (1)",
                arabic: "ÙˆÙŽØ£ÙŽÙ†Ù’ÙˆÙŽØ§Ø¹Ù Ø§Ù„Ù’Ø¹ÙØ¨ÙŽØ§Ø¯ÙŽØ©Ù Ø§Ù„ÙŽÙ‘ØªÙÙŠ Ø£ÙŽÙ…ÙŽØ±ÙŽ Ø§Ù„Ù„Ù‡Ù Ø¨ÙÙ‡ÙŽØ§: Ù…ÙØ«Ù’Ù„Ù Ø§Ù„Ø¥ÙØ³Ù’Ù„Ø§Ù…ÙØŒ ÙˆÙŽØ§Ù„Ø¥ÙÙŠÙ…ÙŽØ§Ù†ÙØŒ ÙˆÙŽØ§Ù„Ø¥ÙØ­Ù’Ø³ÙŽØ§Ù†ÙØŒ ÙˆÙŽÙ…ÙÙ†Ù’Ù‡Ù: Ø§Ù„Ø¯ÙÙ‘Ø¹ÙŽØ§Ø¡ÙØŒ ÙˆÙŽØ§Ù„Ù’Ø®ÙŽÙˆÙ’ÙÙØŒ ÙˆÙŽØ§Ù„Ø±ÙŽÙ‘Ø¬ÙŽØ§Ø¡ÙØŒ ÙˆÙŽØ§Ù„ØªÙŽÙ‘ÙˆÙŽÙƒÙÙ‘Ù„Ù.",
                phonics: "Wa anwÄ'ul-ibÄdatil-latÄ« amarallÄhu bihÄ... Al-du'Ä, wal-khawf, wal-rajÄ, wat-tawakkul...",
                english: "Forms of worship commanded by Allah: Islam, Iman, Ihsan, and: Supplication, Fear, Hope, and Trust.",
                scholarNote: "Worship ('Ibadah) is everything Allah loves. Directing any of these to others is Shirk Akbar. Du'a is the brain/core of worship.",
                evidence: "Du'a proof: 40:60. Fear (Khawf) proof: 3:175. Hope (Raja) proof: 18:110. Trust (Tawakkul) proof: 5:23 & 65:3."
            },
            {
                id: 7,
                category: "Foundation 1",
                title: "Types of Worship (2)",
                arabic: "ÙˆÙŽÙ…ÙÙ†Ù’Ù‡Ù: Ø§Ù„Ø±ÙŽÙ‘ØºÙ’Ø¨ÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ø±ÙŽÙ‘Ù‡Ù’Ø¨ÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ù’Ø®ÙØ´ÙÙˆØ¹ÙØŒ ÙˆÙŽØ§Ù„Ù’Ø®ÙŽØ´Ù’ÙŠÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ø¥ÙÙ†ÙŽØ§Ø¨ÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ø§Ø³Ù’ØªÙØ¹ÙŽØ§Ù†ÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ø§Ø³Ù’ØªÙØ¹ÙŽØ§Ø°ÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ø§Ø³Ù’ØªÙØºÙŽØ§Ø«ÙŽØ©Ù.",
                phonics: "Al-raghbah, wal-rahbah, wal-khushÅ«', wal-khashyah, wal-inÄbah, wal-isti'Änah, wal-isti'Ädhah, wal-istighÄthah.",
                english: "Also: Longing, Dread, Humility, Awe, Repentance, Seeking help, Seeking refuge, and Seeking rescue.",
                scholarNote: "Heart-actions are the most dangerous to direct toward others. Seeking help (Isti'anah) in what only Allah can do must be for Him alone.",
                evidence: "Raghbah/Rahbah/Khushu: 21:90. Khashyah: 2:150. Inabah: 39:54. Isti'anah: 1:5. Isti'adhah: 113:1. Istighathah: 8:9."
            },
            {
                id: 8,
                category: "Foundation 1",
                title: "Types of Worship (3)",
                arabic: "ÙˆÙŽÙ…ÙÙ†Ù’Ù‡Ù: Ø§Ù„Ø°ÙŽÙ‘Ø¨Ù’Ø­ÙØŒ ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø°Ù’Ø±Ù. ÙˆÙŽØ§Ù„Ø¯ÙŽÙ‘Ù„ÙÙŠÙ„Ù Ù‚ÙŽÙˆÙ’Ù„ÙÙ‡Ù ØªÙŽØ¹ÙŽØ§Ù„ÙŽÙ‰: {Ù‚ÙÙ„Ù’ Ø¥ÙÙ†ÙŽÙ‘ ØµÙŽÙ„Ø§ØªÙÙŠ ÙˆÙŽÙ†ÙØ³ÙÙƒÙÙŠ ÙˆÙŽÙ…ÙŽØ­Ù’ÙŠÙŽØ§ÙŠÙŽ ÙˆÙŽÙ…ÙŽÙ…ÙŽØ§ØªÙÙŠ Ù„ÙÙ„ÙŽÙ‘Ù‡Ù Ø±ÙŽØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙŽØ§Ù„ÙŽÙ…ÙÙŠÙ†ÙŽ}.",
                phonics: "Wa minhu: Al-dhabhu, wan-nadhru. Wa dalÄ«lu: Qul inna salÄtÄ« wa nusukÄ«...",
                english: "Also: Sacrifice (Slaughtering) and Vows. 'Say: Indeed my prayer and my sacrifice... are for Allah.'",
                scholarNote: "Slaughtering for a grave, a saint, or a jinn is Major Shirk that takes one out of the fold of Islam.",
                evidence: "Sacrifice proof: 6:162. Vows (Nadhr) proof: 76:7: 'They fulfill their vows and fear a Day whose evil will be widespread.'"
            },
            {
                id: 9,
                category: "Foundation 2",
                title: "Knowledge of Islam",
                arabic: "Ø§Ù„Ø£ÙŽØµÙ’Ù„Ù Ø§Ù„Ø«ÙŽÙ‘Ø§Ù†ÙÙŠ: Ù…ÙŽØ¹Ù’Ø±ÙÙÙŽØ©Ù Ø¯ÙÙŠÙ†Ù Ø§Ù„Ø¥ÙØ³Ù’Ù„Ø§Ù…Ù Ø¨ÙØ§Ù„Ø£ÙŽØ¯ÙÙ„ÙŽÙ‘Ø©ÙØŒ ÙˆÙŽÙ‡ÙÙˆÙŽ: Ø§Ù„Ø§Ø³Ù’ØªÙØ³Ù’Ù„Ø§Ù…Ù Ù„ÙÙ„ÙŽÙ‘Ù‡Ù Ø¨ÙØ§Ù„ØªÙŽÙ‘ÙˆÙ’Ø­ÙÙŠØ¯ÙØŒ ÙˆÙŽØ§Ù„Ø§Ù†Ù’Ù‚ÙÙŠÙŽØ§Ø¯Ù Ù„ÙŽÙ‡Ù Ø¨ÙØ§Ù„Ø·ÙŽÙ‘Ø§Ø¹ÙŽØ©ÙØŒ ÙˆÙŽØ§Ù„Ù’Ø¨ÙŽØ±ÙŽØ§Ø¡ÙŽØ©Ù Ù…ÙÙ†ÙŽ Ø§Ù„Ø´ÙÙ‘Ø±Ù’ÙƒÙ ÙˆÙŽØ£ÙŽÙ‡Ù’Ù„ÙÙ‡Ù. ÙˆÙŽÙ‡ÙÙˆÙŽ Ø«ÙŽÙ„Ø§Ø«Ù Ù…ÙŽØ±ÙŽØ§ØªÙØ¨ÙŽ: Ø§Ù„Ø¥ÙØ³Ù’Ù„Ø§Ù…ÙØŒ ÙˆÙŽØ§Ù„Ø¥ÙÙŠÙ…ÙŽØ§Ù†ÙØŒ ÙˆÙŽØ§Ù„Ø¥ÙØ­Ù’Ø³ÙŽØ§Ù†Ù.",
                phonics: "Al-asluth-thÄnÄ«: Ma'rifatu dÄ«nil-islÄm... Al-istislÄmu lillÄhi bit-tawhÄ«d, wal-inqiyÄdu lahu bit-tÄ'ah...",
                english: "Second Principle: Knowledge of Islam. Submission with Tawhid, yielding in obedience, and disavowing Shirk. Levels: Islam, Iman, and Ihsan.",
                scholarNote: "Islam has a social/political pillar: Al-BarÄ'ah (Disavowal). You cannot claim Tawhid while keeping spiritual love for idols and Shirk.",
                evidence: "Evidence for the 5 Pillars: The Hadith of Ibn Umar. Evidence for the levels: The Hadith of Jibril."
            },
            {
                id: 10,
                category: "Foundation 2",
                title: "Level 2: Al-Iman (Faith)",
                arabic: "Ø§Ù„Ù’Ù…ÙŽØ±Ù’ØªÙŽØ¨ÙŽØ©Ù Ø§Ù„Ø«ÙŽÙ‘Ø§Ù†ÙÙŠÙŽØ©Ù: Ø§Ù„Ø¥ÙÙŠÙ…ÙŽØ§Ù†ÙØŒ ÙˆÙŽÙ‡ÙÙˆÙŽ Ø¨ÙØ¶Ù’Ø¹ÙŒ ÙˆÙŽØ³ÙŽØ¨Ù’Ø¹ÙÙˆÙ†ÙŽ Ø´ÙØ¹Ù’Ø¨ÙŽØ©Ù‹... ÙˆÙŽØ£ÙŽØ±Ù’ÙƒÙŽØ§Ù†ÙÙ‡Ù Ø³ÙØªÙŽÙ‘Ø©ÙŒ: Ø£ÙŽÙ†Ù’ ØªÙØ¤Ù’Ù…ÙÙ†ÙŽ Ø¨ÙØ§Ù„Ù„Ù‡ÙØŒ ÙˆÙŽÙ…ÙŽÙ„Ø§Ø¦ÙÙƒÙŽØªÙÙ‡ÙØŒ ÙˆÙŽÙƒÙØªÙØ¨ÙÙ‡ÙØŒ ÙˆÙŽØ±ÙØ³ÙÙ„ÙÙ‡ÙØŒ ÙˆÙŽØ§Ù„Ù’ÙŠÙŽÙˆÙ’Ù…Ù Ø§Ù„Ø¢Ø®ÙØ±ÙØŒ ÙˆÙŽØªÙØ¤Ù’Ù…ÙÙ†ÙŽ Ø¨ÙØ§Ù„Ù’Ù‚ÙŽØ¯ÙŽØ±Ù Ø®ÙŽÙŠÙ’Ø±ÙÙ‡Ù ÙˆÙŽØ´ÙŽØ±ÙÙ‘Ù‡Ù.",
                phonics: "Al-martabathuth-thÄniyah: Al-Ä«mÄn... wa arkÄnuhu sittah...",
                english: "Level 2: Iman. It has 70+ branches. Its pillars are six: Belief in Allah, Angels, Books, Messengers, the Last Day, and Pre-decree (Qadr).",
                scholarNote: "Faith is belief in the heart, speech on the tongue, and action of the limbs. It increases with obedience and decreases with sin.",
                evidence: "Proof for 6 Pillars: 'Righteousness is not that you turn your faces... but righteousness is [in] one who believes in Allah...' (2:177). Proof for Qadr: 'Indeed, all things We created with predestination' (54:49)."
            },
            {
                id: 11,
                category: "Foundation 2",
                title: "Level 3: Al-Ihsan (Excellence)",
                arabic: "Ø§Ù„Ù’Ù…ÙŽØ±Ù’ØªÙŽØ¨ÙŽØ©Ù Ø§Ù„Ø«ÙŽÙ‘Ø§Ù„ÙØ«ÙŽØ©Ù: Ø§Ù„Ø¥ÙØ­Ù’Ø³ÙŽØ§Ù†ÙØŒ Ø±ÙÙƒÙ’Ù†ÙŒ ÙˆÙŽØ§Ø­ÙØ¯ÙŒØŒ ÙˆÙŽÙ‡ÙÙˆÙŽ: Ø£ÙŽÙ†Ù’ ØªÙŽØ¹Ù’Ø¨ÙØ¯ÙŽ Ø§Ù„Ù„Ù‡ÙŽ ÙƒÙŽØ£ÙŽÙ†ÙŽÙ‘ÙƒÙŽ ØªÙŽØ±ÙŽØ§Ù‡ÙØŒ ÙÙŽØ¥ÙÙ†Ù’ Ù„ÙŽÙ…Ù’ ØªÙŽÙƒÙÙ†Ù’ ØªÙŽØ±ÙŽØ§Ù‡Ù ÙÙŽØ¥ÙÙ†ÙŽÙ‘Ù‡Ù ÙŠÙŽØ±ÙŽØ§ÙƒÙŽ.",
                phonics: "Al-martabathuth-thÄlithah: Al-ihsÄn, ruknun wÄhid...",
                english: "Level 3: Ihsan. It has one pillar: To worship Allah as if you see Him, and if you do not see Him, then indeed He sees you.",
                scholarNote: "This is the highest level. It produces constant consciousness (Muraqabah) and absolute sincerity (Ikhlas).",
                evidence: "Proof: 'Indeed, Allah is with those who fear Him and those who are doers of good' (16:128) and 'And rely upon the Exalted in Might, the Merciful, Who sees you when you arise' (26:217-218)."
            },
            {
                id: 12,
                category: "Foundation 3",
                title: "Knowledge of the Prophet ï·º",
                arabic: "Ø§Ù„Ø£ÙŽØµÙ’Ù„Ù Ø§Ù„Ø«ÙŽÙ‘Ø§Ù„Ø«Ù: Ù…ÙŽØ¹Ù’Ø±ÙÙÙŽØ©Ù Ù†ÙŽØ¨ÙÙŠÙÙ‘ÙƒÙÙ…Ù’ Ù…ÙØ­ÙŽÙ…ÙŽÙ‘Ø¯Ù ØµÙ„Ù‰ Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙ‡ ÙˆØ³Ù„Ù…ØŒ ÙˆÙŽÙ‡ÙÙˆÙŽ: Ù…ÙØ­ÙŽÙ…ÙŽÙ‘Ø¯Ù Ø¨Ù’Ù†Ù Ø¹ÙŽØ¨Ù’Ø¯Ù Ø§Ù„Ù„Ù‡Ù Ø¨Ù’Ù†Ù Ø¹ÙŽØ¨Ù’Ø¯Ù Ø§Ù„Ù’Ù…ÙØ·ÙŽÙ‘Ù„ÙØ¨Ù Ø¨Ù’Ù†Ù Ù‡ÙŽØ§Ø´ÙÙ…Ù... Ø¹ÙÙ…Ù’Ø±ÙÙ‡Ù Ø«ÙŽÙ„Ø§Ø«ÙŒ ÙˆÙŽØ³ÙØªÙÙ‘ÙˆÙ†ÙŽ Ø³ÙŽÙ†ÙŽØ©Ù‹... Ø¨ÙØ¹ÙØ«ÙŽ Ø¨ÙØ§Ù„ØªÙŽÙ‘ÙˆÙ’Ø­ÙÙŠØ¯Ù ÙˆÙŽØ£ÙŽÙ†Ù’Ø°ÙŽØ±ÙŽ Ø¹ÙŽÙ†Ù Ø§Ù„Ø´ÙÙ‘Ø±Ù’ÙƒÙ.",
                phonics: "Al-asluth-thÄlith: Ma'rifatu nabiyyikum Muhammad... 'umruhu thalÄthun wa sittÅ«na sanah...",
                english: "Third Principle: Knowledge of the Prophet ï·º. He lived 63 years. Prophet at 40, Messenger for 23. Sent with Tawhid to warn against Shirk.",
                scholarNote: "He spent 13 years in Makkah calling only to Tawhid before the migration (Hijrah) to Madinah to establish the Shariah.",
                evidence: "Prophethood: Surah al-Alaq (Iqra). Messengership: Surah al-Muddathir: 'O you covered in garments, arise and warn!' Meaning: warn against Shirk and call to Tawhid."
            },
            {
                id: 13,
                category: "Conclusion",
                title: "The Resurrection & Accounting",
                arabic: "ÙˆÙŽØ¬ÙŽÙ…ÙÙŠØ¹Ù Ø§Ù„Ù†ÙŽÙ‘Ø§Ø³Ù ÙŠÙŽØ¨Ù’Ø¹ÙŽØ«ÙÙˆÙ†ÙŽ Ø¨ÙŽØ¹Ù’Ø¯ÙŽ Ø§Ù„Ù’Ù…ÙŽÙˆÙ’ØªÙ... ÙˆÙŽÙ…ÙŽÙ†Ù’ ÙƒÙŽØ°ÙŽÙ‘Ø¨ÙŽ Ø¨ÙØ§Ù„Ù’Ø¨ÙŽØ¹Ù’Ø«Ù ÙƒÙŽÙÙŽØ±ÙŽ. ÙˆÙŽØ§Ù„Ø¯ÙŽÙ‘Ù„ÙÙŠÙ„Ù Ù‚ÙŽÙˆÙ’Ù„ÙÙ‡Ù ØªÙŽØ¹ÙŽØ§Ù„ÙŽÙ‰: {Ø²ÙŽØ¹ÙŽÙ…ÙŽ Ø§Ù„ÙŽÙ‘Ø°ÙÙŠÙ†ÙŽ ÙƒÙŽÙÙŽØ±ÙÙˆØ§ Ø£ÙŽÙ† Ù„ÙŽÙ‘Ù† ÙŠÙØ¨Ù’Ø¹ÙŽØ«ÙÙˆØ§ Ù‚ÙÙ„Ù’ Ø¨ÙŽÙ„ÙŽÙ‰ ÙˆÙŽØ±ÙŽØ¨ÙÙ‘ÙŠ Ù„ÙŽØªÙØ¨Ù’Ø¹ÙŽØ«ÙÙ†ÙŽÙ‘}.",
                phonics: "Wa jamÄ«'un-nÄsi yab'athÅ«na ba'dal-mawt... wa man kadhdhaba bil-ba'thi kafar.",
                english: "All will be resurrected after death. Denying the Resurrection is disbelief (Kufr). Every nation had a Messenger calling to Tawhid.",
                scholarNote: "Faith in the Last Day is a pillar of Iman. The goal of every Messenger from Nuh to Muhammad was to command the worship of Allah and avoid the Taghut.",
                evidence: "Proof: 'The disbelievers claim that they will never be resurrected. Say, Yes, by my Lord, you will surely be resurrected' (64:7)."
            },
            {
                id: 14,
                category: "Conclusion",
                title: "The Rejection of Taghut",
                arabic: "ÙˆÙŽØ§Ù„Ø·ÙŽÙ‘ÙˆÙŽØ§ØºÙÙŠØªÙ ÙƒÙŽØ«ÙÙŠØ±ÙŽØ©ÙŒØŒ ÙˆÙŽØ±ÙØ¤ÙÙˆØ³ÙÙ‡ÙÙ…Ù’ Ø®ÙŽÙ…Ù’Ø³ÙŽØ©ÙŒ: Ø¥ÙØ¨Ù’Ù„ÙÙŠØ³Ù Ù„ÙŽØ¹ÙŽÙ†ÙŽÙ‡Ù Ø§Ù„Ù„Ù‡ÙØŒ ÙˆÙŽÙ…ÙŽÙ†Ù’ Ø¹ÙØ¨ÙØ¯ÙŽ ÙˆÙŽÙ‡ÙÙˆÙŽ Ø±ÙŽØ§Ø¶ÙØŒ ÙˆÙŽÙ…ÙŽÙ†Ù’ Ø¯ÙŽØ¹ÙŽØ§ Ø§Ù„Ù†ÙŽÙ‘Ø§Ø³ÙŽ Ø¥ÙÙ„ÙŽÙ‰ Ø¹ÙØ¨ÙŽØ§Ø¯ÙŽØ©Ù Ù†ÙŽÙÙ’Ø³ÙÙ‡ÙØŒ ÙˆÙŽÙ…ÙŽÙ†Ù’ Ø§Ø¯ÙŽÙ‘Ø¹ÙŽÙ‰ Ø´ÙŽÙŠÙ’Ø¦Ø§Ù‹ Ù…ÙÙ†Ù’ Ø¹ÙÙ„Ù’Ù…Ù Ø§Ù„Ù’ØºÙŽÙŠÙ’Ø¨ÙØŒ ÙˆÙŽÙ…ÙŽÙ†Ù’ Ø­ÙŽÙƒÙŽÙ…ÙŽ Ø¨ÙØºÙŽÙŠÙ’Ø±Ù Ù…ÙŽØ§ Ø£ÙŽÙ†Ù’Ø²ÙŽÙ„ÙŽ Ø§Ù„Ù„Ù‡Ù.",
                phonics: "Wal-tawÄghÄ«tu kathÄ«rah... wa ru'Å«suhum khamsah...",
                english: "The Taghut are many, and their heads are five: Iblis, whoever is worshipped and is pleased, whoever calls people to worship him, whoever claims unseen knowledge, and whoever judges by other than Allah's law.",
                scholarNote: "Rejecting the Taghut (everything worshipped beside Allah) is the first half of the Shahadah. Tawhid is invalid without this rejection.",
                evidence: "Proof: 'There is no compulsion in religion... whoever disbelieves in Taghut and believes in Allah has grasped the most trustworthy handhold' (2:256)."
            }
        ];

        const quizQuestions = [
            { q: "What is the first obligatory matter to learn?", a: ["Action", "Patience", "Knowledge", "Dawah"], c: 2, e: "Knowledge of Allah, His Prophet, and Islam must precede any speech or action." },
            { q: "Which Surah summarizes the four foundations of success?", a: ["Al-Fatiha", "Al-Asr", "Al-Ikhlas", "Al-Mulk"], c: 1, e: "Imam Shafi'i said Surah al-Asr is a sufficient proof for mankind." },
            { q: "Knowledge must be 'with evidence'. What does this mean?", a: ["From logic", "From ancestors", "From Quran & Sunnah", "From personal opinion"], c: 2, e: "Evidence refers to revelation, protecting from blind imitation." },
            { q: "What does 'hamala' (neglected) mean in the context of creation?", a: ["Left in wealth", "Left without purpose or messenger", "Left in Paradise", "Left in sorrow"], c: 1, e: "Mankind was created for worship and provided with guidance." },
            { q: "Allah is not pleased that Shirk be committed even with:", a: ["Angels or Prophets", "Stones", "Animals", "Wealth"], c: 0, e: "Even the highest creation cannot share in Allah's right to worship." },
            { q: "The word 'Aalamin' (Worlds) refers to:", a: ["Only humans", "Only angels", "Everything other than Allah", "Only the earth"], c: 2, e: "Allah is the Lord of all things that exist." },
            { q: "Directing 'Du'a' (Supplication) to a saint or grave is:", a: ["Minor Shirk", "Innovation", "Major Shirk", "Permissible"], c: 2, e: "Du'a is the essence of worship; directing it to others is Shirk Akbar." },
            { q: "Slaughtering (Sacrifice) for other than Allah is:", a: ["A minor mistake", "Cursed by the Prophet", "A cultural custom", "Recommended"], c: 1, e: "Sacrifice is an act of worship belonging only to Allah." },
            { q: "How many levels (Maratib) are there in the religion?", a: ["One", "Two", "Three", "Five"], c: 2, e: "Islam, Iman, and Ihsan." },
            { q: "Which level is 'To worship Allah as if you see Him'?", a: ["Islam", "Iman", "Ihsan", "Taqwa"], c: 2, e: "Ihsan is the level of perfection and excellence." },
            { q: "How many pillars are there for 'Al-Iman'?", a: ["Five", "Six", "Seven", "Ten"], c: 1, e: "Faith in Allah, Angels, Books, Messengers, Last Day, Qadr." },
            { q: "The definition of Islam includes:", a: ["Only prayer", "Submission with Tawhid, Obedience, & Disavowal of Shirk", "Only giving charity", "Just being kind"], c: 1, e: "Islam is a complete submission of belief, action, and loyalty." },
            { q: "At what age was Muhammad ï·º made a Prophet?", a: ["25", "33", "40", "63"], c: 2, e: "He received the first revelation (Iqra) at age 40." },
            { q: "Which Surah made him ï·º a 'Messenger' (to warn people)?", a: ["Al-Alaq", "Al-Fatiha", "Al-Muddathir", "Al-Kahf"], c: 2, e: "Prophethood started with Al-Alaq, Messengership with Al-Muddathir." },
            { q: "How many years was he ï·º calling to Tawhid in Makkah?", a: ["5", "10", "13", "23"], c: 2, e: "13 years in Makkah, followed by 10 years in Madinah." },
            { q: "Belief in the Resurrection is:", a: ["A minor part of faith", "A pillar of Iman", "Optional", "Only for scholars"], c: 1, e: "Belief in the Last Day is one of the six pillars of Iman." },
            { q: "What is the 'Trustworthy Handhold'?", a: ["Charity", "Rejecting Taghut and Believing in Allah", "Strength", "Lineage"], c: 1, e: "Tawhid is incomplete without the rejection of falsehood." },
            { q: "How many 'heads' of Taghut are listed in the book?", a: ["Three", "Five", "Seven", "Nine"], c: 1, e: "Iblis, the one worshipped and pleased, the claimer of unseen knowledge, etc." },
            { q: "Denying the Resurrection after death is:", a: ["Fisq", "Bida'h", "Kufr (Disbelief)", "A mistake"], c: 2, e: "Denying it is a rejection of Allah's promise and power." },
            { q: "True or False: Tawhid is valid if you believe in Allah but respect idols?", a: ["True", "False"], c: 1, e: "One must disavow Shirk and its people for Tawhid to be valid." }
        ];

        function App() {
            const [page, setPage] = useState(0);
            const [mode, setMode] = useState('study'); // study, quiz
            const [focus, setFocus] = useState(false);
            const [phonics, setPhonics] = useState(false);
            
            // Quiz State
            const [qIdx, setQIdx] = useState(0);
            const [score, setScore] = useState(0);
            const [ans, setAns] = useState(null);
            const [done, setDone] = useState(false);

            const handleAns = (i) => {
                if (ans !== null) return;
                setAns(i);
                if (i === quizQuestions[qIdx].c) setScore(score + 1);
            };

            const resetQuiz = () => { setQIdx(0); setScore(0); setAns(null); setDone(false); };

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header */}
                    <header className={`glass-header sticky top-0 z-50 px-5 py-4 flex items-center justify-between transition-all-400 ${focus ? '-translate-y-full opacity-0' : 'translate-y-0 opacity-100'}`}>
                        <div className="flex items-center gap-3">
                            <div className="bg-[#4A3728] text-white w-10 h-10 rounded-2xl flex items-center justify-center font-black shadow-lg">U</div>
                            <div>
                                <h1 className="text-sm font-black text-[#3E2723] uppercase tracking-tighter">Usul Master</h1>
                                <p className="text-[9px] text-stone-400 font-bold uppercase tracking-widest">Unabridged Edition</p>
                            </div>
                        </div>
                        <div className="flex bg-stone-100 p-1 rounded-2xl border border-stone-200">
                            <button onClick={() => setMode('study')} className={`px-5 py-2 rounded-xl text-[10px] font-black uppercase transition-all ${mode === 'study' ? 'bg-white shadow-sm text-[#4A3728]' : 'text-stone-400'}`}>Learn</button>
                            <button onClick={() => setMode('quiz')} className={`px-5 py-2 rounded-xl text-[10px] font-black uppercase transition-all ${mode === 'quiz' ? 'bg-[#4A3728] text-white shadow-md' : 'text-stone-400'}`}>Test</button>
                        </div>
                    </header>

                    {/* Content */}
                    <main className="flex-1 max-w-2xl mx-auto w-full p-4 md:pt-10">
                        {mode === 'study' ? (
                            <div className="space-y-6 pb-44">
                                <div className="flex justify-between items-center px-2">
                                    <button onClick={() => setFocus(!focus)} className="text-[10px] font-black uppercase tracking-wider bg-white border border-stone-200 px-4 py-2 rounded-xl text-stone-400 hover:text-[#4A3728] transition-colors shadow-sm">
                                        {focus ? 'Restore Controls' : 'Focus Mode'}
                                    </button>
                                    <button onClick={() => setPhonics(!phonics)} className={`px-4 py-2 rounded-xl text-[10px] font-black uppercase border transition-all shadow-sm ${phonics ? 'bg-[#4A3728] text-white border-[#4A3728]' : 'bg-white text-stone-400 border-stone-200'}`}>
                                        Phonics Helper
                                    </button>
                                </div>

                                <div className="bg-white rounded-[2.5rem] border border-stone-200 content-card p-8 md:p-14 relative transition-all-400">
                                    <div className="flex items-center gap-2 mb-10 opacity-60">
                                        <div className="w-1 h-4 bg-[#4A3728] rounded-full"></div>
                                        <span className="text-[10px] font-black uppercase tracking-[0.2em]">{bookData[page].category} â€¢ {bookData[page].title}</span>
                                    </div>
                                    
                                    <div dir="rtl" className="mb-14">
                                        <p className="arabic text-3xl md:text-5xl text-[#1A1614] leading-[2.4] antialiased whitespace-pre-line tracking-tight">
                                            {bookData[page].arabic}
                                        </p>
                                    </div>

                                    {phonics && (
                                        <div className="bg-stone-50 p-6 rounded-3xl border border-dashed border-stone-200 mb-12 animate-in fade-in duration-500">
                                            <p className="text-[13px] text-stone-500 font-mono italic leading-relaxed">{bookData[page].phonics}</p>
                                        </div>
                                    )}

                                    <div className="space-y-12">
                                        <div className="relative border-l-2 border-[#EBDCCB] pl-6">
                                            <p className="text-xl md:text-2xl text-[#5D4037] font-serif leading-relaxed italic whitespace-pre-line relative z-10">
                                                "{bookData[page].english}"
                                            </p>
                                        </div>

                                        <div className="pt-12 border-t border-stone-100 space-y-10">
                                            <div className="space-y-4">
                                                <div className="flex items-center gap-3">
                                                    <span className="text-[10px] font-black uppercase tracking-widest text-stone-400">Scholarly Overview</span>
                                                    <div className="flex-1 h-[1px] bg-stone-100"></div>
                                                </div>
                                                <p className="text-[15px] text-[#4A3728] leading-loose font-medium">{bookData[page].scholarNote}</p>
                                            </div>

                                            <div className="bg-[#FAF8F5] p-8 rounded-[2rem] border border-[#EBDCCB]/60 shadow-inner">
                                                <div className="flex items-center gap-2 mb-5">
                                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#8D6E63" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>
                                                    <h3 className="text-[11px] font-black uppercase tracking-wider text-[#8D6E63]">Detailed Proof & Context</h3>
                                                </div>
                                                <p className="text-sm text-[#795548] leading-relaxed mb-6 italic opacity-90">{bookData[page].detailedSharh}</p>
                                                
                                                <div className="flex items-center gap-3 pt-6 border-t border-[#EBDCCB]/30 text-[#8D6E63]">
                                                    <span className="text-[10px] font-black uppercase tracking-tighter">Ad-Dalil (The Proof):</span>
                                                    <p className="text-[11px] italic flex-1 leading-relaxed">{bookData[page].evidence}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="animate-in fade-in duration-500 pb-32">
                                {!done ? (
                                    <div className="bg-white rounded-[2.5rem] border border-stone-200 content-card p-8 md:p-14">
                                        <div className="flex items-center justify-between mb-10">
                                            <span className="text-[11px] font-black uppercase text-stone-400 tracking-[0.2em]">Exam {qIdx + 1} / {quizQuestions.length}</span>
                                            <div className="bg-stone-50 text-stone-400 px-3 py-1 rounded-full text-[10px] font-black">Score: {score}</div>
                                        </div>
                                        
                                        <h2 className="text-2xl font-serif font-bold mb-12 text-[#2C241E] leading-relaxed">{quizQuestions[qIdx].q}</h2>
                                        
                                        <div className="grid grid-cols-1 gap-4">
                                            {quizQuestions[qIdx].a.map((opt, i) => (
                                                <button key={i} onClick={() => handleAns(i)} disabled={ans !== null} className={`w-full text-left p-6 rounded-2xl border-2 transition-all text-sm font-bold flex items-center gap-4 ${ans !== null ? i === quizQuestions[qIdx].c ? 'bg-emerald-50 border-emerald-500 text-emerald-800' : ans === i ? 'bg-red-50 border-red-500 text-red-800' : 'opacity-40 border-stone-100' : 'bg-white border-stone-100 hover:border-[#4A3728] hover:bg-stone-50 shadow-sm'}`}>
                                                    <span className={`w-8 h-8 rounded-full flex items-center justify-center text-[10px] shrink-0 font-black ${ans !== null && i === quizQuestions[qIdx].c ? 'bg-emerald-500 text-white' : 'bg-stone-100 text-stone-400'}`}>{String.fromCharCode(65 + i)}</span>
                                                    {opt}
                                                </button>
                                            ))}
                                        </div>

                                        {ans !== null && (
                                            <div className="mt-12 bg-stone-50 p-8 rounded-[2rem] border border-stone-200 animate-in slide-in-from-top-4 duration-500">
                                                <div className="flex items-center gap-2 mb-4">
                                                    <div className={`w-2 h-2 rounded-full ${ans === quizQuestions[qIdx].c ? 'bg-emerald-500' : 'bg-red-500'}`}></div>
                                                    <p className="text-[10px] font-black uppercase tracking-widest text-stone-400">{ans === quizQuestions[qIdx].c ? 'Correct Insight' : 'Review Note'}</p>
                                                </div>
                                                <p className="text-[14px] text-[#5D4037] leading-relaxed mb-8 italic">"{quizQuestions[qIdx].e}"</p>
                                                <button onClick={() => { 
                                                    if (qIdx < quizQuestions.length - 1) { setQIdx(qIdx + 1); setAns(null); } 
                                                    else setDone(true);
                                                }} className="w-full py-5 bg-[#4A3728] text-white rounded-2xl text-[11px] font-black uppercase tracking-[0.2em] shadow-xl hover:bg-[#3E2723] active:scale-95 transition-all">
                                                    {qIdx === quizQuestions.length - 1 ? 'End Examination' : 'Continue'}
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                ) : (
                                    <div className="text-center py-20 bg-white rounded-[3rem] border border-stone-200 content-card px-10">
                                        <div className="w-24 h-24 bg-amber-50 rounded-full flex items-center justify-center mx-auto mb-8 shadow-inner">
                                            <span className="text-4xl">ðŸ“š</span>
                                        </div>
                                        <h2 className="text-4xl font-black text-[#4A3728] mb-4 tracking-tighter">{Math.round((score/quizQuestions.length)*100)}%</h2>
                                        <p className="text-stone-400 text-[10px] mb-12 uppercase tracking-[0.4em] font-black italic">Mastery Certification</p>
                                        <div className="flex flex-col gap-4 max-w-xs mx-auto">
                                            <button onClick={resetQuiz} className="w-full py-5 bg-[#4A3728] text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-xl transition-all active:scale-95">Restart Exam</button>
                                            <button onClick={() => setMode('study')} className="w-full py-5 bg-white border-2 border-stone-200 text-[#4A3728] rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all">Return to Library</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* Bottom Nav: Derived from focus and mode */}
                    {mode === 'study' && !focus && (
                        <footer className="fixed bottom-8 left-1/2 -translate-x-1/2 w-[92%] max-w-sm z-50 transition-all-400 animate-in fade-in slide-in-from-bottom-5">
                            <div className="bg-white border border-stone-200 p-4 rounded-3xl shadow-[0_30px_70px_-15px_rgba(74,55,40,0.35)] flex items-center justify-between">
                                <button
                                    onClick={() => setPage(Math.max(0, page - 1))}
                                    className="w-14 h-14 flex items-center justify-center rounded-2xl text-stone-400 hover:text-[#4A3728] hover:bg-stone-50 transition-all active:scale-90 disabled:opacity-30"
                                    disabled={page === 0}
                                >
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="m15 18-6-6 6-6"/>
                                    </svg>
                                </button>

                                <div className="flex flex-col items-center">
                                    <div className="flex gap-1.5 mb-1.5">
                                        {bookData.map((_, i) => (
                                            <div
                                                key={i}
                                                className={`h-1.5 rounded-full transition-all duration-500 ${i === page ? 'w-6 bg-[#4A3728]' : 'w-1.5 bg-stone-200'}`}
                                            />
                                        ))}
                                    </div>
                                    <span className="text-[10px] font-black uppercase tracking-widest text-stone-400">
                                        Module {page + 1}
                                    </span>
                                </div>

                                <button
                                    onClick={() => setPage(Math.min(bookData.length - 1, page + 1))}
                                    className="w-14 h-14 flex items-center justify-center rounded-2xl bg-[#4A3728] text-white shadow-xl shadow-[#4A3728]/30 disabled:opacity-20 transition-all active:scale-90"
                                    disabled={page === bookData.length - 1}
                                >
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="m9 18 6-6-6-6"/>
                                    </svg>
                                </button>
                            </div>
                        </footer>
                    )}

                    {/* Focus Mode Restore Button */}
                    {focus && mode === 'study' && (
                        <button 
                            onClick={() => setFocus(false)}
                            className="fixed bottom-8 right-8 w-12 h-12 bg-[#4A3728] text-white rounded-full flex items-center justify-center shadow-2xl animate-bounce z-50 transition-all active:scale-90"
                        >
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M18 15l-6-6-6 6"/></svg>
                        </button>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

